import{_ as h,h as v,u as w,r as l,b as k,c as r,a as s,w as i,v as u,g as _,o as m}from"./index-ClYnPMaO.js";import{a as d}from"./axios-BimPEqV4.js";const b={id:"loginPage",class:"bg-yellow"},y={class:"conatiner loginPage vhContainer"},x={class:"formControls",action:"index.html"},C={key:0},c="https://todolist-api.hexschool.io",$={__name:"LoginPage",setup(q){const p=v(),n=w(),t=l({email:"",password:""}),g=l({nickname:"",uid:""}),f=async()=>{try{const e=await d.post(`${c}/users/sign_in`,t.value),o=e.data.token,a=e.data.nickname;document.cookie=`customTodoToken=${o}; path=/;`,p.push({path:"/todolist",query:{nickname:a}})}catch(e){e.response&&e.response.data.message?alert(`登入失敗：${e.response.data.message}`):console.error("未知的登入錯誤：",e)}};return k(async()=>{n.query.email&&(t.value.email=n.query.email);const e=document.cookie.replace(/(?:(?:^|.*;\s*)customTodoToken\s*\=\s*([^;]*).*$)|^.*$/,"$1");if(e)try{const o=await d.get(`${c}/users/checkout`,{headers:{Authorization:e}});g.value=o.data}catch(o){console.log("驗證失敗",o)}}),(e,o)=>(m(),r("div",b,[s("div",y,[o[6]||(o[6]=s("div",{class:"side"},[s("a",{href:"#"},[s("img",{class:"logoImg",src:"https://raw.githubusercontent.com/hexschool/2022-web-layout-training/main/todolist/logo.png",alt:""})]),s("img",{class:"d-m-n",src:"https://raw.githubusercontent.com/hexschool/2022-web-layout-training/main/todolist/img.png",alt:"workImg"})],-1)),s("div",null,[s("form",x,[o[2]||(o[2]=s("h2",{class:"formControls_txt"},"最實用的線上代辦事項服務",-1)),o[3]||(o[3]=s("label",{class:"formControls_label",for:"email"},"Email",-1)),i(s("input",{class:"formControls_input",type:"text",id:"email","onUpdate:modelValue":o[0]||(o[0]=a=>t.value.email=a),name:"email",placeholder:"請輸入 email",required:""},null,512),[[u,t.value.email]]),t.value.email?_("",!0):(m(),r("span",C,"此欄位不可留空")),o[4]||(o[4]=s("label",{class:"formControls_label",for:"pwd"},"密碼",-1)),i(s("input",{class:"formControls_input",type:"password",name:"pwd",id:"pwd password",placeholder:"請輸入密碼",required:"","onUpdate:modelValue":o[1]||(o[1]=a=>t.value.password=a)},null,512),[[u,t.value.password]]),s("input",{class:"formControls_btnSubmit",type:"button",value:"登入",onClick:f}),o[5]||(o[5]=s("a",{class:"formControls_btnLink",href:"/sign_up"},"註冊帳號",-1))])])])]))}},B=h($,[["__scopeId","data-v-7c975bc0"]]);export{B as default};
